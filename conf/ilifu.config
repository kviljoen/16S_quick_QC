/*
 * -------------------------------------------------
 *  ILIFU cluster config file (fastqc-bbduk)
 * -------------------------------------------------
 * http://www.ilifu.ac.za/
 */

singularity {
   enabled = true
   cacheDir = "/ceph/cbio/users/katie/singularity_containers/"
}

   	/*--------------------------------*
	 *	PATHS TO EXTERNAL RESOURCES
	 *--------------------------------*/
params {	
	//Adapter sequences and synthetic contaminants to be removed in the trimming step
	adapters="/opt/conda/opt/bbmap-37.10/resources/adapters.fa" //available in resources folder of bbmap installation by default	
	artifacts="/opt/conda/opt/bbmap-37.10/resources/sequencing_artifacts.fa.gz" //available in resources folder of bbmap installation by default
	phix174ill="/opt/conda/opt/bbmap-37.10/resources/phix174_ill.ref.fa.gz"	//available in resources folder of bbmap installation by default
	
	//Reference pan-genome for contamination. It should have been indexed beforehand.
	refForeignGenome="/ceph/cbio/users/katie/" //index human contaminants downloaded from https://zenodo.org/record/1208052/files/hg19_main_mask_ribo_animal_allplant_allfungus.fa.gz
	
	max_memory = 256.GB
   	max_cpus = 64
   	max_time = 1000.h
	email = "katieviljoen@gmail.com"
}

process {
   container = "/ceph/cbio/users/katie/singularity_containers/4a531b6d42e9-2018-09-17-43655c9a1ee3.img";
   $multiqc.container='/ceph/cbio/users/katie/singularity_containers/44d9f4cd3afb-2019-04-04-351547ea1862.img';

   executor = 'slurm'
   stageInMode = 'symlink'
   stageOutMode = 'rsync'
   queue = 'Main'

   // Increasing maxRetries, this will overwrite what we have in base.config
   maxRetries = 4
}

executor{
   jobName = { "$task.tag" }
}

timeline {
		  enabled = true
		  file = "${params.outdir}/pipeline_info/Tychus_assembly_timeline.html"
		}
      
report   {
		  enabled = true
		  file = "${params.outdir}/pipeline_info/Tychus_assembly_report.html"
		}
      
trace    {
		  enabled = true
		  file = "${params.outdir}/pipeline_info/Tychus_assembly_trace.txt"
		}
      
dag      {
		  enabled = true
		  file = "${params.outdir}/pipeline_info/Tychus_assembly_DAG.svg"
		}
